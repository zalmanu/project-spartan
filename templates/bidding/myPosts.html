{% extends 'base.html' %}
{% load staticfiles %}
{% block content %}
        <section class="wrap" id="secound-section">
                    <section class="wrapper">
                         <div class="row title-row"> </div>
            </div>
              
                  
              </div>
<div class="container">
  <div class="row">
    {% for post in posts %}
        <div class="col-md-12">
        <h4>Anuntul:<b id="post_title_bidders">
	    <a href="{{ post.get_absolute_url }}">{{ post.title }}</a></b>
	</h4>
        <div class="table-responsive">

              <table id="mytable" class="table table-bordred table-striped"
                  data-table-post="{{ post.id }}">
            
     {% if post.spartan %}
     <thead>
       <th>First Name</th>
       <th>Last Name</th>
       <th>Email</th>
       <th>Suna Licitata</th>
       <th>Lucrare terminata</th>
     </thead>
     {% if post.spartan_done %}
     <tbody>
       <tr>
         <td>{{ post.spartan.prenume }}</td>
         <td>{{ post.spartan.nume }}</td>
         <td>{{ post.spartan.user.email }}</td>
         <td>{{ post.pret }}</td>
         <td><input type="checkbox" name="work_in_progress" value="finish_work" id="finish_work" class="employer" data-postfin="{{ post.id }}"></td>
       </tr>
     </tbody>
     {% else %}
     <tbody>
       <tr>
         <td>{{ post.spartan.prenume }}</td>
         <td>{{ post.spartan.nume }}</td>
         <td>{{ post.spartan.user.email }}</td>
         <td>{{ post.pret }}</td>
         <td>Waits for spartan's confimation</td>
       </tr>
     </tbody>
     {% endif %}
     {% else %}
     <thead>  
       <th>First Name</th>
       <th>Last Name</th>
       <th>Tipul ofertei</th>
       <th>Suma Licitata</th>
       
       <th>Accept</th>
     </thead>
    <tbody>
    {% if post.oferte.all %}
    {% for oferta in post.oferte.all %}
    <tr>
    <td>{{ oferta.spartan.prenume }}</td>
    <td>{{ oferta.spartan.nume }}</td>
    <td>{{ oferta.tip }}</td>
    <td>{{ oferta.pret }}</td>
    <td><p data-placement="top" data-toggle="tooltip" >
        <button class="btn btn-danger btn-xs hire" data-oferta="{{ oferta.id }}" data-post="{{ post.id }}" id="choose_button" id="hire" >
            <span class="glyphicon glyphicon-ok"></span>
        </button>
      </p>
     </td>
    </tr>
    {% endfor %}
    </tbody>
    {% else %}
    <tr>
    <td> Nobody made an offer,yet. </td>
    </tbody>
    {% endif %}
    {% endif %}
</table>

<div class="clearfix"></div>
        </div>
            
        </div>
{% endfor %}
      </div>
{% if bids %}
<div class="col-md-12">
  <h4>Bids<b id="post_title_bidders"></h4>
  <div class="table-responsive">

    <table id="mytable" class="table table-bordred table-striped"
           data-table-post="{{ post.id }}">
      <thead>  
	<th>Annoucement title</th>
	<th>Offer type</th>
	<th>Suma licitata</th>       
	<th>Job done</th>
      </thead>
      <tbody>
	{% for bid in bids %}
	{% if bid.post.status and bid.status and bid.post.spartan_done %}
	<tr>
	  <td>{{ bid.post.title }}</td>
	  <td>{{ bid.tip }}</td>
	  <td>{{ bid.pret }}</td>
	  <td>Waiting for employer's confimations</td>
	  </td>
	</tr>
	{% elif bid.post.status and bid.status %}
	<tr>
	  <td>{{ bid.post.title }}</td>
	  <td>{{ bid.tip }}</td>
	  <td>{{ bid.pret }}</td>
	  <td><input type="checkbox" name="work_in_progress" value="finish_work" id="finish_work" class="spartan" data-post="{{ bid.post.id }}"></td>
	  </td>
	</tr>
	{% elif not bid.post.status and not bid.status %}
	<tr>
	  <td>{{ bid.post.title }}</td>
	  <td>{{ bid.tip }}</td>
	  <td>{{ bid.pret }}</td>
	  <td>Offer wasn't accepted, yet.</td>
	</tr>
	{% endif %}
	{% endfor %}
      </tbody>

{% endif %}
</table>

<div class="clearfix"></div>
        </div>
        </div>

    </div>
</div>




<div class="modal fade" id="edit" tabindex="-1" role="dialog" aria-labelledby="edit" aria-hidden="true">
      <div class="modal-dialog">
    <div class="modal-content">
          <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button>
        <h4 class="modal-title custom_align" id="Heading">Edit Your Detail</h4>
      </div>
          <div class="modal-body">
          <div class="form-group">
        <input class="form-control " type="text" placeholder="Mohsin">
        </div>
        <div class="form-group">
        
        <input class="form-control " type="text" placeholder="Irshad">
        </div>
        <div class="form-group">
        <textarea rows="2" class="form-control" placeholder="CB 106/107 Street # 11 Wah Cantt Islamabad Pakistan"></textarea>
    
        
        </div>
      </div>
          <div class="modal-footer ">
        <button type="button" class="btn btn-warning btn-lg" style="width: 100%;"><span class="glyphicon glyphicon-ok-sign"></span> Update</button>
      </div>
        </div>
    <!-- /.modal-content --> 
  </div>
      <!-- /.modal-dialog --> 
    </div>
    
    
    
    <div class="modal fade confirmation_box" id="delete" tabindex="-1" role="dialog" aria-labelledby="edit" aria-hidden="true">
      <div class="modal-dialog">
    <div class="modal-content">
          <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button>
        <h4 class="modal-title custom_align" id="Heading">Confirmare:</h4>
      </div>
          <div class="modal-body">
       
       <div class="alert alert-danger"><span class="glyphicon glyphicon-warning-sign"></span>Sunteti sigur ca doriti sa incheiati acest contract cu aceasta persoana?</div>
       
      </div>p
        <div class="modal-footer ">
        <button type="button" class="btn btn-success" ><span class="glyphicon glyphicon-ok-sign"></span> Yes</button>
        <button type="button" class="btn btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> No</button>
      </div>
        </div>
    <!-- /.modal-content --> 
  </div>
      <!-- /.modal-dialog --> 
    </div>
    <div class="container">
    <div class="row">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
        


              <!-- page end-->
          </section>
</section>
        </section>
    <script>
      // Jquery pentru accept 
    $(document).ready(function(){
        $(".hire").click(function(event){
            var oferta = $(this).data("oferta");
            var post_id = $(this).data("post");
            $.post("/posts/", { "oferta": oferta }, function(response) {
                 if (response.result == "success") {
                     console.log("success");
                     $(location).attr('href', '/posts/')
                 }
            })
            return true;
        });
    });
    </script>                
        <script>
	  // Jquery pentru job done la Spartan
    $(document).ready(function(){
        $(".spartan").change(function(event){
          var post_id = $(this).data("post");
            $.post("/posts/", { "post": post_id }, function(response) {
                 if (response.result == "success") {
                     console.log("success");
                     $(location).attr('href', '/posts/')
                 }
            })
            return true; 
        });
    });
    </script>               
        <script>
	  // Jquery pentru job done la employer
    $(document).ready(function(){
        $(".employer").change(function(event){
          var post_id = $(this).data("postfin");
            $.post("/posts/", { "post_empl": post_id }, function(response) {
                 if (response.result == "success") {
                     console.log("success");
                     $(location).attr('href', '/posts/')
                 }
            })
            return true; 
        });
    });
    </script> 
        <script>
        $(document).ready(function(){
            $('[data-toggle="tooltip"]').tooltip(); 
        });
        </script>
        <script>
                $("#show_other_bids").click(function(){
                    $(".each_bid").toggleClass('show_bids');
                });
        </script>
        <script>
            $(document).ready(function(){
            $("#mytable #checkall").click(function () {
                    if ($("#mytable #checkall").is(':checked')) {
                        $("#mytable input[type=checkbox]").each(function () {
                            $(this).prop("checked", true);
                        });

                    } else {
                        $("#mytable input[type=checkbox]").each(function () {
                            $(this).prop("checked", false);
                        });
                    }
                });
                
                $("[data-toggle=tooltip]").tooltip();
            });
        </script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
{% endblock %}

